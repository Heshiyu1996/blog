(window.webpackJsonp=window.webpackJsonp||[]).push([[55],{391:function(t,a,s){t.exports=s.p+"assets/img/img-1.0de01db4.png"},604:function(t,a,s){"use strict";s.r(a);var r=s(43),e=Object(r.a)({},(function(){var t=this,a=t.$createElement,r=t._self._c||a;return r("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[r("h1",{attrs:{id:"基于antd的业务组件库"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#基于antd的业务组件库"}},[t._v("#")]),t._v(" 基于Antd的业务组件库")]),t._v(" "),r("blockquote",[r("p",[t._v("主要技术：react(16.9.0) + antd(3.23.3) + dumi(1.0.8) + lerna(3.20.2)")])]),t._v(" "),r("p"),r("div",{staticClass:"table-of-contents"},[r("ul",[r("li",[r("a",{attrs:{href:"#基于antd的业务组件库"}},[t._v("基于Antd的业务组件库")]),r("ul",[r("li",[r("a",{attrs:{href:"#关于开发流程"}},[t._v("关于开发流程")])]),r("li",[r("a",{attrs:{href:"#关于发布流程"}},[t._v("关于发布流程")])]),r("li",[r("a",{attrs:{href:"#注意事项"}},[t._v("注意事项")])])])])])]),r("p"),t._v(" "),r("h2",{attrs:{id:"关于开发流程"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#关于开发流程"}},[t._v("#")]),t._v(" 关于开发流程")]),t._v(" "),r("p",[t._v("当新增一个组件：")]),t._v(" "),r("ul",[r("li",[t._v("在 src 下新建组件文件夹，和往常一样开发组件")]),t._v(" "),r("li",[t._v("在 src/index.ts 将组件输出")]),t._v(" "),r("li",[t._v("找到 docs/components 下，撰写组件相关文档即可\n"),r("blockquote",[r("p",[t._v("在撰写文档DEMO时，可直接以用户的身份，直接从我们的库（@netease-ehr/ui） 引入组件。")]),t._v(" "),r("p",[t._v("这是因为在 dumi内置机制、搭配 tsconfig.json 的 alias 、 作了特殊处理。dumi的alias处理")])])])]),t._v(" "),r("h2",{attrs:{id:"关于发布流程"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#关于发布流程"}},[t._v("#")]),t._v(" 关于发布流程")]),t._v(" "),r("h3",{attrs:{id:"项目打包"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#项目打包"}},[t._v("#")]),t._v(" 项目打包")]),t._v(" "),r("ul",[r("li",[t._v("进入组件库项目")]),t._v(" "),r("li",[t._v("执行 npm login，登录 npm 账号。若已登录可跳过")]),t._v(" "),r("li",[t._v("提升 package.json 的 version")]),t._v(" "),r("li",[t._v("执行 yarn build")]),t._v(" "),r("li",[t._v("最后执行 npm publish")])]),t._v(" "),r("h3",{attrs:{id:"文档打包"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#文档打包"}},[t._v("#")]),t._v(" 文档打包")]),t._v(" "),r("ul",[r("li",[t._v("执行 yarn run docs:build")]),t._v(" "),r("li",[t._v("最后执行 yarn run docs:deploy")])]),t._v(" "),r("blockquote",[r("p",[t._v("注意：")]),t._v(" "),r("p",[t._v("1、文档打包 应该在 项目打包 之后进行，因为它们共用同一个dist文件")]),t._v(" "),r("p",[t._v("2、对于组合指令（yarn run release、yarn run deploy）无法实现，可后续调研是什么原因")])]),t._v(" "),r("h2",{attrs:{id:"注意事项"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#注意事项"}},[t._v("#")]),t._v(" 注意事项")]),t._v(" "),r("h3",{attrs:{id:"_1、组件中antd样式丢失问题"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#_1、组件中antd样式丢失问题"}},[t._v("#")]),t._v(" 1、组件中antd样式丢失问题")]),t._v(" "),r("h4",{attrs:{id:"问题-之前出现过-组件库发布到npm上-被其他项目引用时-组件里用到的antd样式丢失问题"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#问题-之前出现过-组件库发布到npm上-被其他项目引用时-组件里用到的antd样式丢失问题"}},[t._v("#")]),t._v(" 问题：之前出现过 组件库发布到npm上，被其他项目引用时，组件里用到的Antd样式丢失问题")]),t._v(" "),r("p",[t._v("原因：原先采用的是 rollup 打包，采用的是 umd 形式，css会与js分离，导致不会css不会被打包进。")]),t._v(" "),r("p",[t._v("解决：现采用 babel方式 进行打包，且搭配 babel-plugin-import 对 antd 样式进行按需加载")]),t._v(" "),r("p",[r("img",{attrs:{src:s(391),alt:"alt"}})]),t._v(" "),r("h3",{attrs:{id:"_2、文档部署到-github-io-后-页面资源问题"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#_2、文档部署到-github-io-后-页面资源问题"}},[t._v("#")]),t._v(" 2、文档部署到 github.io 后，页面资源问题")]),t._v(" "),r("h4",{attrs:{id:"问题一-刷新页面导致404"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#问题一-刷新页面导致404"}},[t._v("#")]),t._v(" 问题一：刷新页面导致404")]),t._v(" "),r("p",[t._v("原因：猜测 dumi 内置使用的是browser history，导致页面刷新后真实地去向服务器查找资源，导致的404")]),t._v(" "),r("p",[t._v("解决：在 .umirc.ts 配置 exportStatic 字段。作用是将所有路由输出为 HTML 目录结构")]),t._v(" "),r("h3",{attrs:{id:"问题二-路由根路径不正确"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#问题二-路由根路径不正确"}},[t._v("#")]),t._v(" 问题二：路由根路径不正确")]),t._v(" "),r("p",[t._v("原因：我们组件库的 github.io 地址是https://netease-frontend-institute.github.io/ehr/，所以对于组件库内部路由的 baseUrl 实际上是 /ehr/")]),t._v(" "),r("p",[t._v("解决：在 .umirc.ts 配置 base、publicPath 这两个字段，分别定义路由、静态资源的根路径。")])])}),[],!1,null,null,null);a.default=e.exports}}]);
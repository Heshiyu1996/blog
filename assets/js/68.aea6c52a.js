(window.webpackJsonp=window.webpackJsonp||[]).push([[68],{531:function(t,s,a){t.exports=a.p+"assets/img/img-1.156d3730.png"},737:function(t,s,a){"use strict";a.r(s);var e=a(56),n=Object(e.a)({},(function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("h1",{attrs:{id:"vue3-0新特性"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#vue3-0新特性"}},[t._v("#")]),t._v(" Vue3.0新特性")]),t._v(" "),e("p"),e("div",{staticClass:"table-of-contents"},[e("ul",[e("li",[e("a",{attrs:{href:"#vue3-0新特性"}},[t._v("Vue3.0新特性")]),e("ul",[e("li",[e("a",{attrs:{href:"#function-based-api"}},[t._v("Function-based API")])]),e("li",[e("a",{attrs:{href:"#proxy"}},[t._v("Proxy")])]),e("li",[e("a",{attrs:{href:"#参考链接"}},[t._v("参考链接")])])])])])]),e("p"),t._v(" "),e("h2",{attrs:{id:"function-based-api"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#function-based-api"}},[t._v("#")]),t._v(" Function-based API")]),t._v(" "),e("h3",{attrs:{id:"在使用上"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#在使用上"}},[t._v("#")]),t._v(" 在使用上")]),t._v(" "),e("ul",[e("li",[t._v("更灵活的逻辑复用")]),t._v(" "),e("li",[t._v("没有命名空间冲突")]),t._v(" "),e("li",[t._v("数据来源清晰")])]),t._v(" "),e("h3",{attrs:{id:"目前vue里逻辑组合复用的方式"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#目前vue里逻辑组合复用的方式"}},[t._v("#")]),t._v(" 目前Vue里逻辑组合复用的方式")]),t._v(" "),e("ul",[e("li",[t._v("Mixins")]),t._v(" "),e("li",[t._v("HOC")]),t._v(" "),e("li",[t._v("Renderless Component（基于scoped slots封装逻辑的组件）")])]),t._v(" "),e("p",[t._v("缺点：")]),t._v(" "),e("ul",[e("li",[t._v("数据来源不明（Mixins、HOC）")]),t._v(" "),e("li",[t._v("命名空间冲突（Mixins）")]),t._v(" "),e("li",[t._v("性能损耗（HOC）")])]),t._v(" "),e("h3",{attrs:{id:"setup"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#setup"}},[t._v("#")]),t._v(" setup")]),t._v(" "),e("p",[t._v("调用时机：在组件实例被创建、且初始化props后")]),t._v(" "),e("p",[t._v("作用："),e("code",[t._v("return")]),t._v("对象里的属性会被暴露给模板的渲染上下文")]),t._v(" "),e("p",[e("img",{attrs:{src:a(531),alt:"alt"}}),t._v(";")]),t._v(" "),e("h2",{attrs:{id:"proxy"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#proxy"}},[t._v("#")]),t._v(" Proxy")]),t._v(" "),e("p",[t._v("vue3.0 会用 "),e("code",[t._v("Proxy")]),t._v(" 来实现响应式数据。")]),t._v(" "),e("h3",{attrs:{id:"废弃object-defineproperty原因"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#废弃object-defineproperty原因"}},[t._v("#")]),t._v(" 废弃"),e("code",[t._v("Object.defineProperty")]),t._v("原因")]),t._v(" "),e("p",[t._v("在 vue2.x，"),e("strong",[t._v("改变数组下标")]),t._v(" 不能来实现响应式数据的自动更新。")]),t._v(" "),e("p",[e("strong",[t._v("实际上，"),e("code",[t._v("Object.defineProperty")]),t._v(" 能监听 数组、对象。出于性价比考虑，Vue放弃了这个特性")]),t._v("。")]),t._v(" "),e("p",[t._v("原因：")]),t._v(" "),e("ul",[e("li",[t._v("对数组进行数据劫持，可能会导致误触发getter、setter；")]),t._v(" "),e("li",[t._v("需要对新增的元素手动observer。\n"),e("ul",[e("li",[t._v("如对数组"),e("code",[t._v("[1, 2, 3]")]),t._v("进行数据劫持，调用"),e("code",[t._v("unshift(0)")]),t._v("，那只有下标为"),e("code",[t._v("0、1、2")]),t._v("的元素具有劫持效果")])])])]),t._v(" "),e("p",[t._v("解决："),e("strong",[t._v("重写数组方法")])]),t._v(" "),e("p",[t._v("我们平时可以通过调用数组的"),e("code",[t._v("变异方法")]),t._v("来实现响应式，是"),e("strong",[t._v("因为 "),e("code",[t._v("vue 2.x")]),t._v(" 重写了数组方法")]),t._v("。")]),t._v(" "),e("blockquote",[e("p",[t._v("在Observer类里，对数据进行了判断，会将"),e("code",[t._v("arrayMethods")]),t._v("重写到原型上")])]),t._v(" "),e("p",[t._v("当触发这些被重写的数组方法时，会触发手动observe。")]),t._v(" "),e("h3",{attrs:{id:"object-defineproperty和proxy的区别"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#object-defineproperty和proxy的区别"}},[t._v("#")]),t._v(" Object.defineProperty和Proxy的区别")]),t._v(" "),e("p",[e("code",[t._v("Object.defineProperty")]),t._v(" 只能对属性进行劫持，需要遍历对象的每个属性。")]),t._v(" "),e("p",[e("code",[t._v("proxy")]),t._v(" 是直接代理对象。")]),t._v(" "),e("div",{staticClass:"language-js line-numbers-mode"},[e("pre",{pre:!0,attrs:{class:"language-js"}},[e("code",[e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" handler "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("set")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("target"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" key"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" value"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        cocnsole"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("key"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'set'")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        target"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("key"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" value"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" target "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" proxy "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Proxy")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("target"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" handler"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\nproxy"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("push")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),t._v(" "),e("div",{staticClass:"line-numbers-wrapper"},[e("span",{staticClass:"line-number"},[t._v("1")]),e("br"),e("span",{staticClass:"line-number"},[t._v("2")]),e("br"),e("span",{staticClass:"line-number"},[t._v("3")]),e("br"),e("span",{staticClass:"line-number"},[t._v("4")]),e("br"),e("span",{staticClass:"line-number"},[t._v("5")]),e("br"),e("span",{staticClass:"line-number"},[t._v("6")]),e("br"),e("span",{staticClass:"line-number"},[t._v("7")]),e("br"),e("span",{staticClass:"line-number"},[t._v("8")]),e("br"),e("span",{staticClass:"line-number"},[t._v("9")]),e("br"),e("span",{staticClass:"line-number"},[t._v("10")]),e("br"),e("span",{staticClass:"line-number"},[t._v("11")]),e("br")])]),e("p",[t._v("但是"),e("code",[t._v("Proxy")]),t._v("的兼容性差，IE不支持。但后续可能会出现polyfill方案。")]),t._v(" "),e("h2",{attrs:{id:"参考链接"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#参考链接"}},[t._v("#")]),t._v(" 参考链接")]),t._v(" "),e("p",[e("a",{attrs:{href:"https://juejin.im/post/5da29a87518825094e37301c",target:"_blank",rel:"noopener noreferrer"}},[t._v("为什么Vue3.0使用Proxy实现数据监听？defineProperty表示不背这个锅"),e("OutboundLink")],1)])])}),[],!1,null,null,null);s.default=n.exports}}]);
(window.webpackJsonp=window.webpackJsonp||[]).push([[50],{397:function(t,s,a){t.exports=a.p+"assets/img/img-1.d0ac8fac.png"},613:function(t,s,a){"use strict";a.r(s);var n=a(56),r=Object(n.a)({},(function(){var t=this,s=t.$createElement,n=t._self._c||s;return n("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[n("h1",{attrs:{id:"chrome-extension"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#chrome-extension"}},[t._v("#")]),t._v(" Chrome Extension")]),t._v(" "),n("p"),n("div",{staticClass:"table-of-contents"},[n("ul",[n("li",[n("a",{attrs:{href:"#chrome-extension"}},[t._v("Chrome Extension")]),n("ul",[n("li",[n("a",{attrs:{href:"#特点"}},[t._v("特点")])]),n("li",[n("a",{attrs:{href:"#_4类js"}},[t._v("4类JS")])]),n("li",[n("a",{attrs:{href:"#业务需求"}},[t._v("业务需求")])]),n("li",[n("a",{attrs:{href:"#manifest-json"}},[t._v("manifest.json")])]),n("li",[n("a",{attrs:{href:"#难点记录"}},[t._v("难点记录")])]),n("li",[n("a",{attrs:{href:"#实践笔记"}},[t._v("实践笔记")])]),n("li",[n("a",{attrs:{href:"#参考链接"}},[t._v("参考链接")])])])])])]),n("p"),t._v(" "),n("h2",{attrs:{id:"特点"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#特点"}},[t._v("#")]),t._v(" 特点")]),t._v(" "),n("p",[t._v("拥有一份清单（"),n("code",[t._v("manifest.json")]),t._v("），可以声明并赋能以下行为：")]),t._v(" "),n("ul",[n("li",[t._v("浏览器行为：监听标签⻚/窗⼝、LocalStorage")]),t._v(" "),n("li",[t._v("⽹页⾏为：操作DOM")]),t._v(" "),n("li",[t._v("特殊⾏为：跨域请求、消息通信、cookies读写")])]),t._v(" "),n("h2",{attrs:{id:"_4类js"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#_4类js"}},[t._v("#")]),t._v(" 4类JS")]),t._v(" "),n("p",[t._v("分别是："),n("code",[t._v("background")]),t._v("、"),n("code",[t._v("content")]),t._v("、"),n("code",[t._v("injected")]),t._v("、"),n("code",[t._v("popup")])]),t._v(" "),n("table",[n("thead",[n("tr",[n("th",[t._v("JS 种类")]),t._v(" "),n("th",[t._v("可访问API")]),t._v(" "),n("th",[t._v("DOM")]),t._v(" "),n("th",[t._v("JS")]),t._v(" "),n("th",[t._v("是否跨域")]),t._v(" "),n("th",[t._v("职责")])])]),t._v(" "),n("tbody",[n("tr",[n("td",[t._v("background")]),t._v(" "),n("td",[t._v("绝大部分API")]),t._v(" "),n("td",[t._v("✘")]),t._v(" "),n("td",[t._v("✘")]),t._v(" "),n("td",[t._v("✔")]),t._v(" "),n("td",[t._v("1、监听标签页"),n("br"),t._v("2、跨域请求"),n("br"),t._v("3、和content通信")])]),t._v(" "),n("tr",[n("td",[t._v("content")]),t._v(" "),n("td",[t._v("只访问插件部分API")]),t._v(" "),n("td",[t._v("✔")]),t._v(" "),n("td",[t._v("✘")]),t._v(" "),n("td",[t._v("✘")]),t._v(" "),n("td",[t._v("1、嵌入到目标页"),n("br"),t._v("2、获取网页DOM"),n("br"),t._v("3、和background、inject通信")])]),t._v(" "),n("tr",[n("td",[t._v("injected")]),t._v(" "),n("td",[t._v("不能访问")]),t._v(" "),n("td",[t._v("✔")]),t._v(" "),n("td",[t._v("✔")]),t._v(" "),n("td",[t._v("✘")]),t._v(" "),n("td",[t._v("1、展示数据"),n("br"),t._v("2、接收用户行为"),n("br"),t._v("3、和content通信")])])])]),t._v(" "),n("h3",{attrs:{id:"js之间通信"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#js之间通信"}},[t._v("#")]),t._v(" JS之间通信")]),t._v(" "),n("p",[n("img",{attrs:{src:a(397),alt:"alt"}})]),t._v(" "),n("h2",{attrs:{id:"业务需求"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#业务需求"}},[t._v("#")]),t._v(" 业务需求")]),t._v(" "),n("p",[t._v("用户打开指定页面时，插件界面自动弹出：")]),t._v(" "),n("p",[t._v("1、会立即"),n("strong",[t._v("向服务器请求")]),t._v("进行判断，将"),n("strong",[t._v("结果呈现")]),t._v("到插件界面；")]),t._v(" "),n("p",[t._v("2、将界面的"),n("strong",[t._v("DOM信息")]),t._v("以base64图片形式发送给服务器")]),t._v(" "),n("h2",{attrs:{id:"manifest-json"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#manifest-json"}},[t._v("#")]),t._v(" manifest.json")]),t._v(" "),n("div",{staticClass:"language-json line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-json"}},[n("code",[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"manifest_version"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 固定")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"name"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"hehsiyu"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 插件名称")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"version"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"1.0"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 插件版本")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"description"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"The first extension."')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 插件描述")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"browser_action"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"default_icon"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"icon.png"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 图表图片")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"default_title"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"Hello"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 图标title")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"default_popup"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"popup.html"')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 单击图标会执行的文件")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 允许插件访问的url")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"permissions"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"http://*/"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"tabs"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"storage"')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 如果需要通过popup页面保存数据，可以通过通信将数据交给后台页面处理；或者通过chrome.storage保存到用户的硬盘上。")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// background script，即插件运行的环境。")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 因为popup页面在关闭后，就相当于用户关闭了相应的标签页，这个页面再次打开时，所有DOM和JS空间变量都将被重新创建。所以需要扩展实时处理数据，而不是在用户打开时才运行")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"background"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"page"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"background.html"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v('// "scripts": ["js/jquery-1.9.1.min.js","js/background.js"]//数组.chrome会在扩展启动时自动创建一个包含所有指定脚本的页面')]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 对页面内容进行操作的脚本")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"content_scripts"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"matches"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"http://*/*"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"https://*/*"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"js"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"js/jquery-1.9.1.min.js"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"js/js.js"')]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        "),n("span",{pre:!0,attrs:{class:"token property"}},[t._v('"run_at"')]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token string"}},[t._v('"document_start"')]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 在document加载时执行该脚本")]),t._v("\n    "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br"),n("span",{staticClass:"line-number"},[t._v("2")]),n("br"),n("span",{staticClass:"line-number"},[t._v("3")]),n("br"),n("span",{staticClass:"line-number"},[t._v("4")]),n("br"),n("span",{staticClass:"line-number"},[t._v("5")]),n("br"),n("span",{staticClass:"line-number"},[t._v("6")]),n("br"),n("span",{staticClass:"line-number"},[t._v("7")]),n("br"),n("span",{staticClass:"line-number"},[t._v("8")]),n("br"),n("span",{staticClass:"line-number"},[t._v("9")]),n("br"),n("span",{staticClass:"line-number"},[t._v("10")]),n("br"),n("span",{staticClass:"line-number"},[t._v("11")]),n("br"),n("span",{staticClass:"line-number"},[t._v("12")]),n("br"),n("span",{staticClass:"line-number"},[t._v("13")]),n("br"),n("span",{staticClass:"line-number"},[t._v("14")]),n("br"),n("span",{staticClass:"line-number"},[t._v("15")]),n("br"),n("span",{staticClass:"line-number"},[t._v("16")]),n("br"),n("span",{staticClass:"line-number"},[t._v("17")]),n("br"),n("span",{staticClass:"line-number"},[t._v("18")]),n("br"),n("span",{staticClass:"line-number"},[t._v("19")]),n("br"),n("span",{staticClass:"line-number"},[t._v("20")]),n("br"),n("span",{staticClass:"line-number"},[t._v("21")]),n("br"),n("span",{staticClass:"line-number"},[t._v("22")]),n("br"),n("span",{staticClass:"line-number"},[t._v("23")]),n("br"),n("span",{staticClass:"line-number"},[t._v("24")]),n("br"),n("span",{staticClass:"line-number"},[t._v("25")]),n("br"),n("span",{staticClass:"line-number"},[t._v("26")]),n("br"),n("span",{staticClass:"line-number"},[t._v("27")]),n("br"),n("span",{staticClass:"line-number"},[t._v("28")]),n("br"),n("span",{staticClass:"line-number"},[t._v("29")]),n("br")])]),n("h2",{attrs:{id:"难点记录"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#难点记录"}},[t._v("#")]),t._v(" 难点记录")]),t._v(" "),n("h3",{attrs:{id:"background-js监听tabs事件"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#background-js监听tabs事件"}},[t._v("#")]),t._v(" background.js监听tabs事件")]),t._v(" "),n("p",[t._v("需要考虑打开页面的每种情况："),n("code",[t._v("打开新tab（跳转）")]),t._v("、"),n("code",[t._v("打开新tab（不跳转）")]),t._v("、"),n("code",[t._v("在当前tab打开/刷新")]),t._v("、"),n("code",[t._v("标签页切换")])]),t._v(" "),n("p",[t._v("相关事件："),n("code",[t._v("onActivated")]),t._v("、"),n("code",[t._v("onUpdated")])]),t._v(" "),n("h3",{attrs:{id:"content-js的注入时机"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#content-js的注入时机"}},[t._v("#")]),t._v(" content.js的注入时机")]),t._v(" "),n("p",[n("code",[t._v("document_start")]),t._v("：css之后、DOM构建之前")]),t._v(" "),n("p",[n("code",[t._v("document_end")]),t._v("：DOM构建之后")]),t._v(" "),n("h3",{attrs:{id:"其它"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#其它"}},[t._v("#")]),t._v(" 其它")]),t._v(" "),n("p",[n("strong",[t._v("技术")]),t._v("：")]),t._v(" "),n("ul",[n("li",[t._v("chrome API大部分都是异步操作、且传参严格")]),t._v(" "),n("li",[t._v("permissions若为无限跨域，发布审核会很严格；且版本迭代时，会通知给使用者")])]),t._v(" "),n("p",[n("strong",[t._v("非技术")]),t._v("：")]),t._v(" "),n("ul",[n("li",[t._v("隐私政策：需提供隐私政策说明才能发布")])]),t._v(" "),n("h2",{attrs:{id:"实践笔记"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#实践笔记"}},[t._v("#")]),t._v(" 实践笔记")]),t._v(" "),n("ul",[n("li",[n("RouterLink",{attrs:{to:"/business/tool/chrome-extension/DEMO.html"}},[t._v("实践笔记")])],1),t._v(" "),n("li",[n("a",{attrs:{href:"/chrome-extension-practise.pdf"}},[t._v("分析与实践PDF")])])]),t._v(" "),n("h2",{attrs:{id:"参考链接"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#参考链接"}},[t._v("#")]),t._v(" 参考链接")]),t._v(" "),n("p",[n("a",{attrs:{href:"https://stackoverflow.com/questions/5544256/chrome-extensionhow-to-pragmatically-open-the-popup-window-from-background-htm",target:"_blank",rel:"noopener noreferrer"}},[t._v("stackoverflow连接"),n("OutboundLink")],1)])])}),[],!1,null,null,null);s.default=r.exports}}]);
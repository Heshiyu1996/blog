(window.webpackJsonp=window.webpackJsonp||[]).push([[184],{758:function(t,e,v){"use strict";v.r(e);var _=v(56),a=Object(_.a)({},(function(){var t=this,e=t.$createElement,v=t._self._c||e;return v("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[v("h1",{attrs:{id:"web性能优化"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#web性能优化"}},[t._v("#")]),t._v(" Web性能优化")]),t._v(" "),v("blockquote",[v("p",[t._v("根据业务情况，定义Web性能指标。然后 选取数据参考点、收集数据 ，随后分析每个关键指标反映的数据，最后采取优化手段。")])]),t._v(" "),v("p"),v("div",{staticClass:"table-of-contents"},[v("ul",[v("li",[v("a",{attrs:{href:"#web性能优化"}},[t._v("Web性能优化")]),v("ul",[v("li",[v("a",{attrs:{href:"#性能指标"}},[t._v("性能指标")])]),v("li",[v("a",{attrs:{href:"#首屏性能优化"}},[t._v("首屏性能优化")])]),v("li",[v("a",{attrs:{href:"#参考链接"}},[t._v("参考链接")])])])])])]),v("p"),t._v(" "),v("h2",{attrs:{id:"性能指标"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#性能指标"}},[t._v("#")]),t._v(" 性能指标")]),t._v(" "),v("p",[t._v("一般会关注 2 个类指标："),v("strong",[t._v("web-vitals指标、传统指标")]),t._v("。")]),t._v(" "),v("h3",{attrs:{id:"web-vitals指标"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#web-vitals指标"}},[t._v("#")]),t._v(" web-vitals指标")]),t._v(" "),v("table",[v("thead",[v("tr",[v("th",[t._v("展示名")]),t._v(" "),v("th",{staticStyle:{"text-align":"center"}},[t._v("字段名")]),t._v(" "),v("th",{staticStyle:{"text-align":"center"}},[t._v("达标标准")])])]),t._v(" "),v("tbody",[v("tr",[v("td",[t._v("LCP")]),t._v(" "),v("td",{staticStyle:{"text-align":"center"}},[t._v("最大内容渲染")]),t._v(" "),v("td",{staticStyle:{"text-align":"center"}},[t._v("75% 用户小于 "),v("code",[t._v("2 秒")]),t._v(" （云音乐内部定义阈值）")])]),t._v(" "),v("tr",[v("td",[t._v("FCP")]),t._v(" "),v("td",{staticStyle:{"text-align":"center"}},[t._v("首个内容渲染")]),t._v(" "),v("td",{staticStyle:{"text-align":"center"}},[t._v("75% 用户小于 "),v("code",[t._v("1 秒")])])]),t._v(" "),v("tr",[v("td",[t._v("CLS")]),t._v(" "),v("td",{staticStyle:{"text-align":"center"}},[t._v("累计布局偏移")]),t._v(" "),v("td",{staticStyle:{"text-align":"center"}},[t._v("75% 用户小于 "),v("code",[t._v("0.1")])])]),t._v(" "),v("tr",[v("td",[t._v("FID")]),t._v(" "),v("td",{staticStyle:{"text-align":"center"}},[t._v("首次交互延时")]),t._v(" "),v("td",{staticStyle:{"text-align":"center"}},[t._v("75% 用户小于 "),v("code",[t._v("0.1 秒")])])])])]),t._v(" "),v("blockquote",[v("p",[t._v("75% 是为了应对极端情况")]),t._v(" "),v("p",[v("RouterLink",{attrs:{to:"/skill/web/web-vitals/"}},[t._v("web-vitals指标详情")])],1)]),t._v(" "),v("h3",{attrs:{id:"传统指标"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#传统指标"}},[t._v("#")]),t._v(" 传统指标")]),t._v(" "),v("ul",[v("li",[v("strong",[t._v("白屏时间")]),t._v("：开始解析渲染DOM的时间（即："),v("code",[t._v("FCP")]),t._v("）\n"),v("ul",[v("li",[v("strong",[t._v("domLoading - fetchStart")])])])]),t._v(" "),v("li",[v("strong",[t._v("首屏时间")]),t._v("：“第一屏内容” 渲染完成的时间\n"),v("ul",[v("li",[v("strong",[t._v("第一屏最后一个内容 - fetchStart")])])])]),t._v(" "),v("li",[v("strong",[t._v("用户可操作时间")]),t._v("：用户可操作时间（即 "),v("code",[t._v("DomReady")]),t._v("）\n"),v("ul",[v("li",[v("strong",[t._v("domContentLoadedEventEnd - fetchStart")])])])]),t._v(" "),v("li",[v("strong",[t._v("页面完全加载时间")]),t._v("：页面所有资源加载完成时间（ "),v("code",[t._v("load")]),t._v(" 事件触发，也叫 “总下载时间” ）\n"),v("ul",[v("li",[v("strong",[t._v("loadEventStart - fetchStart")])])])])]),t._v(" "),v("blockquote",[v("p",[v("strong",[t._v("秒开率")]),t._v(" 指的是 DomReady 在 "),v("code",[t._v("1s")]),t._v(" 内的数据占比。")])]),t._v(" "),v("h2",{attrs:{id:"首屏性能优化"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#首屏性能优化"}},[t._v("#")]),t._v(" 首屏性能优化")]),t._v(" "),v("blockquote",[v("p",[v("a",{attrs:{href:"/business/practice/h5/optimize"}},[t._v("detail")])])]),t._v(" "),v("p",[v("strong",[t._v("首屏性能优化")]),t._v(" 可以从 2 个方面进行：")]),t._v(" "),v("ul",[v("li",[t._v("资源体积")]),t._v(" "),v("li",[t._v("资源加载")])]),t._v(" "),v("blockquote",[v("p",[t._v("具体方案还取决于：实际需求、优先级、综合成本、ROI等。")])]),t._v(" "),v("h3",{attrs:{id:"资源体积"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#资源体积"}},[t._v("#")]),t._v(" 资源体积")]),t._v(" "),v("p",[v("strong",[t._v("目标：体积更小的资源包。")])]),t._v(" "),v("ul",[v("li",[t._v("拆包、减包、压缩")]),t._v(" "),v("li",[t._v("图片优化")])]),t._v(" "),v("h3",{attrs:{id:"资源加载"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#资源加载"}},[t._v("#")]),t._v(" 资源加载")]),t._v(" "),v("p",[v("strong",[t._v("目标：更快地展示内容。")])]),t._v(" "),v("ul",[v("li",[t._v("懒加载")]),t._v(" "),v("li",[t._v("HTTP缓存")]),t._v(" "),v("li",[t._v("CDN分发")]),t._v(" "),v("li",[t._v("SSR")]),t._v(" "),v("li",[t._v("（PWA）ServiceWorker + CacheStorage")]),t._v(" "),v("li",[t._v("（Hybrid）H5离线包、数据预请求")]),t._v(" "),v("li",[v("strong",[t._v("Varnish")]),t._v("：缓存服务器的反向代理")])]),t._v(" "),v("blockquote",[v("p",[t._v("缓存触发顺序：ServiceWorker -> HTTP缓存 -> 离线包 -> CDN -> Varnish")])]),t._v(" "),v("img",{attrs:{src:"https://p5.music.126.net/obj/wo3DlcOGw6DClTvDisK1/7817696310/c927/6976/7ced/b09a94db66d40eba0eac5b2512c66fde.png",width:"600px"}}),t._v(" "),v("div",{staticClass:"custom-block tip"},[v("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),v("h3",{attrs:{id:"指标收集"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#指标收集"}},[t._v("#")]),t._v(" 指标收集")]),t._v(" "),v("p",[t._v("收集指标数据的 2 种方法：")]),t._v(" "),v("ul",[v("li",[v("strong",[t._v("window.performance.timing")])]),t._v(" "),v("li",[v("strong",[t._v("web-vitals")])])]),t._v(" "),v("h4",{attrs:{id:"window-performance-timing"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#window-performance-timing"}},[t._v("#")]),t._v(" window.performance.timing")]),t._v(" "),v("p",[v("code",[t._v("window.performance.timing")]),t._v(" 可以获取 "),v("strong",[t._v("页面渲染过程中，各个时间段的时间戳")]),t._v("。")]),t._v(" "),v("img",{attrs:{src:"https://p6.music.126.net/obj/wo3DlcOGw6DClTvDisK1/7801768838/15e1/ad4f/1047/69fbc1fd74e514fa9618588aa5319d96.png",width:"700px"}}),t._v(" "),v("p",[t._v("几个重要的时间属性：")]),t._v(" "),v("ul",[v("li",[v("code",[t._v("navigationSart")]),t._v("：上一个文档 "),v("code",[t._v("unload")]),t._v(" 的时刻（若上一个文档为空，值为"),v("code",[t._v("fetchStart")]),t._v("）")]),t._v(" "),v("li",[v("code",[t._v("fetchStart")]),t._v("：浏览器请求文档 就绪 的时刻（下一步是检查缓存之前）")]),t._v(" "),v("li",[v("code",[t._v("domLoading")]),t._v("："),v("strong",[t._v("开始解析DOM")]),t._v(" 的时刻")]),t._v(" "),v("li",[v("code",[t._v("domContentLoadedEventEnd")]),t._v("："),v("strong",[t._v("DOM解析完成")]),t._v(" 的时刻（即：触发 "),v("code",[t._v("DOMContentLoaded")]),t._v(" 事件）")]),t._v(" "),v("li",[v("code",[t._v("loadEventStart")]),t._v("："),v("strong",[v("code",[t._v("load")]),t._v(" 事件触发")]),t._v(" 的时刻")]),t._v(" "),v("li",[v("code",[t._v("loadEventEnd")]),t._v("："),v("strong",[v("code",[t._v("load")]),t._v("事件结束")]),t._v(" 的时刻")])]),t._v(" "),v("blockquote",[v("p",[t._v("DOMContentLoaded：页面元素加载完毕，"),v("strong",[t._v("可正常交互")]),t._v("。"),v("strong",[t._v("但图片资源可能还未加载完成")]),t._v("；")]),t._v(" "),v("p",[t._v("load：指页面上 "),v("strong",[t._v("所有资源 都加载完成")]),t._v("。")])]),t._v(" "),v("h4",{attrs:{id:"web-vitals"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#web-vitals"}},[t._v("#")]),t._v(" web-vitals")]),t._v(" "),v("p",[v("code",[t._v("Web-Vitals")]),t._v(" 底层是通过拿到 "),v("code",[t._v("PerformanceEntry")]),t._v("（性能数据的实例） 然后进行分析。")]),t._v(" "),v("blockquote",[v("p",[t._v("如LCP：浏览器 会通过发送一个 "),v("code",[t._v("PerformanceEntry")]),t._v("（"),v("code",[t._v("type")]),t._v(" 为 "),v("code",[t._v("largest-contentful-paint")]),t._v("）来标识最大的内容元素。")])])]),t._v(" "),v("h2",{attrs:{id:"参考链接"}},[v("a",{staticClass:"header-anchor",attrs:{href:"#参考链接"}},[t._v("#")]),t._v(" 参考链接")]),t._v(" "),v("ul",[v("li",[v("RouterLink",{attrs:{to:"/skill/web/optimize/TRANDITION.html"}},[t._v("传统性能检测手段")])],1),t._v(" "),v("li",[v("a",{attrs:{href:"https://juejin.im/post/5df4294d518825128306cd5c#comment",target:"_blank",rel:"noopener noreferrer"}},[t._v("前端性能监控方案（首屏、白屏时间等）"),v("OutboundLink")],1)]),t._v(" "),v("li",[v("a",{attrs:{href:"https://lz5z.com/Web%E6%80%A7%E8%83%BD%E4%BC%98%E5%8C%96-%E9%A6%96%E5%B1%8F%E5%92%8C%E7%99%BD%E5%B1%8F%E6%97%B6%E9%97%B4/",target:"_blank",rel:"noopener noreferrer"}},[t._v("Web 性能优化-首屏和白屏时间"),v("OutboundLink")],1)]),t._v(" "),v("li",[v("a",{attrs:{href:"https://segmentfault.com/a/1190000011516068",target:"_blank",rel:"noopener noreferrer"}},[t._v("全新Chrome Devtools Performance使用指南"),v("OutboundLink")],1)]),t._v(" "),v("li",[v("a",{attrs:{href:"https://juejin.im/post/5d63311be51d45620821ced8",target:"_blank",rel:"noopener noreferrer"}},[t._v("React性能优化的8种方式了解一下？"),v("OutboundLink")],1)]),t._v(" "),v("li",[v("a",{attrs:{href:"https://juejin.im/post/5d548b83f265da03ab42471d#heading-2",target:"_blank",rel:"noopener noreferrer"}},[t._v("Vue 项目性能优化 — 实践指南（网上最全 / 详细）"),v("OutboundLink")],1)]),t._v(" "),v("li",[v("a",{attrs:{href:"https://segmentfault.com/a/1190000018275268?utm_source=tag-newest",target:"_blank",rel:"noopener noreferrer"}},[t._v("前端性能优化--懒加载和预加载"),v("OutboundLink")],1)])])])}),[],!1,null,null,null);e.default=a.exports}}]);
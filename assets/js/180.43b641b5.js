(window.webpackJsonp=window.webpackJsonp||[]).push([[180],{752:function(t,e,_){"use strict";_.r(e);var a=_(56),v=Object(a.a)({},(function(){var t=this,e=t.$createElement,_=t._self._c||e;return _("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[_("h1",{attrs:{id:"http缓存机制"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#http缓存机制"}},[t._v("#")]),t._v(" HTTP缓存机制")]),t._v(" "),_("blockquote",[_("p",[t._v("缓存和重用之前获取的资源对于性能优化很关键。")])]),t._v(" "),_("p"),_("div",{staticClass:"table-of-contents"},[_("ul",[_("li",[_("a",{attrs:{href:"#http缓存机制"}},[t._v("HTTP缓存机制")]),_("ul",[_("li",[_("a",{attrs:{href:"#强缓存"}},[t._v("强缓存")])]),_("li",[_("a",{attrs:{href:"#协商缓存"}},[t._v("协商缓存")])]),_("li",[_("a",{attrs:{href:"#浏览器的应对"}},[t._v("浏览器的应对")])]),_("li",[_("a",{attrs:{href:"#http缓存的应用"}},[t._v("HTTP缓存的应用")])]),_("li",[_("a",{attrs:{href:"#参考链接"}},[t._v("参考链接")])])])])])]),_("p"),t._v(" "),_("h2",{attrs:{id:"强缓存"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#强缓存"}},[t._v("#")]),t._v(" 强缓存")]),t._v(" "),_("table",[_("thead",[_("tr",[_("th",[t._v("字段名称")]),t._v(" "),_("th",{staticStyle:{"text-align":"center"}},[t._v("说明")]),t._v(" "),_("th",{staticStyle:{"text-align":"center"}},[t._v("适用http版本")])])]),t._v(" "),_("tbody",[_("tr",[_("td",[t._v("Pragma")]),t._v(" "),_("td",{staticStyle:{"text-align":"center"}},[t._v("与"),_("code",[t._v("cache-control: no-cache")]),t._v("相同")]),t._v(" "),_("td",{staticStyle:{"text-align":"center"}},[t._v("1.0、1.1")])]),t._v(" "),_("tr",[_("td",[t._v("Expires")]),t._v(" "),_("td",{staticStyle:{"text-align":"center"}},[t._v("设定“缓存过期时间”")]),t._v(" "),_("td",{staticStyle:{"text-align":"center"}},[t._v("1.0、1.1")])]),t._v(" "),_("tr",[_("td",[t._v("Cache-Control")]),t._v(" "),_("td",{staticStyle:{"text-align":"center"}},[t._v("设定“缓存策略”")]),t._v(" "),_("td",{staticStyle:{"text-align":"center"}},[_("strong",[t._v("仅1.1")])])])])]),t._v(" "),_("blockquote",[_("p",[t._v("优先级："),_("code",[t._v("Pragma")]),t._v(" > "),_("code",[t._v("Cache-Control")]),t._v(" > "),_("code",[t._v("Expires")])])]),t._v(" "),_("h3",{attrs:{id:"expires"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#expires"}},[t._v("#")]),t._v(" Expires")]),t._v(" "),_("p",[_("code",[t._v("Expires")]),t._v(" 的时间是 “服务器时间”，可能与 “客户端时间” 匹配不上，导致缓存失效")]),t._v(" "),_("p",[t._v("一般会用来处理 兼容 情况（包括 "),_("code",[t._v("Pragma")]),t._v("）。")]),t._v(" "),_("h3",{attrs:{id:"cache-control"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#cache-control"}},[t._v("#")]),t._v(" Cache-Control")]),t._v(" "),_("p",[_("strong",[t._v("选项：")])]),t._v(" "),_("ul",[_("li",[_("code",[t._v("max-age")]),t._v("：最大周期（单位: s）")]),t._v(" "),_("li",[_("code",[t._v("no-cache")]),t._v("：客户端协商缓存")]),t._v(" "),_("li",[_("code",[t._v("no-store")]),t._v("：不缓存")])]),t._v(" "),_("p",[t._v("在 "),_("strong",[t._v("Request Header")]),t._v("、"),_("strong",[t._v("Response Header")]),t._v(" 都可以使用"),_("code",[t._v("Cache-Control")]),t._v("，区别在于：")]),t._v(" "),_("ul",[_("li",[t._v("前者：指定 "),_("strong",[t._v("这个资源在本次请求的缓存策略")]),t._v("；\n"),_("blockquote",[_("p",[t._v("如: 强制刷新F5时，请求头是"),_("code",[t._v("cache-control: no-cache")]),t._v(" 告知服务器本次需要请求最新资源")])])]),t._v(" "),_("li",[t._v("后者：告知 浏览器 针对 这个资源 的缓存策略")])]),t._v(" "),_("h2",{attrs:{id:"协商缓存"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#协商缓存"}},[t._v("#")]),t._v(" 协商缓存")]),t._v(" "),_("p",[_("strong",[t._v("Response Header")])]),t._v(" "),_("table",[_("thead",[_("tr",[_("th",[t._v("字段名称")]),t._v(" "),_("th",{staticStyle:{"text-align":"center"}},[t._v("说明")]),t._v(" "),_("th",{staticStyle:{"text-align":"center"}},[t._v("适用http版本")])])]),t._v(" "),_("tbody",[_("tr",[_("td",[t._v("Last-Modified")]),t._v(" "),_("td",{staticStyle:{"text-align":"center"}},[t._v("文件的最后一次修改时间")]),t._v(" "),_("td",{staticStyle:{"text-align":"center"}},[t._v("1.0、1.1")])]),t._v(" "),_("tr",[_("td",[t._v("ETag")]),t._v(" "),_("td",{staticStyle:{"text-align":"center"}},[t._v("资源的唯一标识符")]),t._v(" "),_("td",{staticStyle:{"text-align":"center"}},[_("strong",[t._v("仅1.1")])])])])]),t._v(" "),_("p",[_("strong",[t._v("Request Header")])]),t._v(" "),_("table",[_("thead",[_("tr",[_("th",[t._v("字段名称")]),t._v(" "),_("th",{staticStyle:{"text-align":"center"}},[t._v("说明")]),t._v(" "),_("th",{staticStyle:{"text-align":"center"}},[t._v("适用http版本")])])]),t._v(" "),_("tbody",[_("tr",[_("td",[t._v("If-Modified-Since")]),t._v(" "),_("td",{staticStyle:{"text-align":"center"}},[t._v("向服务器请求上次保存的 "),_("code",[t._v("Last-Modified")]),t._v(" 值")]),t._v(" "),_("td",{staticStyle:{"text-align":"center"}},[t._v("1.0、1.1")])]),t._v(" "),_("tr",[_("td",[t._v("If-None-Match")]),t._v(" "),_("td",{staticStyle:{"text-align":"center"}},[t._v("向服务器请求上次保存的 "),_("code",[t._v("ETag")]),t._v(" 值")]),t._v(" "),_("td",{staticStyle:{"text-align":"center"}},[_("strong",[t._v("仅1.1")])])])])]),t._v(" "),_("blockquote",[_("p",[t._v("优先级：ETag > Last-Modified")])]),t._v(" "),_("h3",{attrs:{id:"last-modified"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#last-modified"}},[t._v("#")]),t._v(" Last-Modified")]),t._v(" "),_("p",[t._v("可能进行误判。")]),t._v(" "),_("p",[t._v("例：资源A 已经被请求过，但是又重新生成（内容没变，但 "),_("code",[t._v("Last-Modified")]),t._v(" 变了）")]),t._v(" "),_("blockquote",[_("p",[t._v("一般会用来处理 兼容 情况。")])]),t._v(" "),_("h3",{attrs:{id:"etag"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#etag"}},[t._v("#")]),t._v(" ETag")]),t._v(" "),_("p",[t._v("服务端生成的 "),_("strong",[t._v("资源唯一标识符")]),t._v(" 。")]),t._v(" "),_("h2",{attrs:{id:"浏览器的应对"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#浏览器的应对"}},[t._v("#")]),t._v(" 浏览器的应对")]),t._v(" "),_("ol",[_("li",[t._v("“服务器” 会通过 "),_("strong",[t._v("Response Header")]),t._v("，携带以上四个常用（"),_("code",[t._v("Cache-Control")]),t._v("、"),_("code",[t._v("Expires")]),t._v("、"),_("code",[t._v("Last-Modified")]),t._v("、"),_("code",[t._v("ETag")]),t._v("）的响应头。")]),t._v(" "),_("li",[t._v("“浏览器” 会通过判别这些响应值来决定 "),_("strong",[t._v("是否要使用缓存")]),t._v("。")])]),t._v(" "),_("p",[t._v("在这段时间里，只能通过 "),_("strong",[t._v("强制刷新")]),t._v(" 来请求最新资源（前提是没有接入CDN）")]),t._v(" "),_("div",{staticClass:"custom-block tip"},[_("p",{staticClass:"custom-block-title"},[t._v("TIP")]),t._v(" "),_("table",[_("thead",[_("tr",[_("th",[t._v("刷新行为")]),t._v(" "),_("th",{staticStyle:{"text-align":"center"}},[_("code",[t._v("Request Header")]),t._v("会携带")])])]),t._v(" "),_("tbody",[_("tr",[_("td",[t._v("F5、工具栏的刷新按钮")]),t._v(" "),_("td",{staticStyle:{"text-align":"center"}},[_("strong",[t._v("If-Modified-Since")]),t._v("（如果上次Response里有"),_("code",[t._v("Last-Modified")]),t._v("）、"),_("strong",[t._v("If-None-Match")]),t._v("（如果上次Response里有"),_("code",[t._v("ETag")]),t._v("）")])]),t._v(" "),_("tr",[_("td",[t._v("Ctrl + F5")]),t._v(" "),_("td",{staticStyle:{"text-align":"center"}},[_("strong",[t._v("Pragma: no-cache")]),t._v("、"),_("strong",[t._v("Cache-Control: no-cache")])])])])])]),t._v(" "),_("h2",{attrs:{id:"http缓存的应用"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#http缓存的应用"}},[t._v("#")]),t._v(" HTTP缓存的应用")]),t._v(" "),_("ul",[_("li",[_("p",[t._v("“强缓存” 通常只针对 “静态资源”、“接口” 使用。")])]),t._v(" "),_("li",[_("p",[t._v("“协商缓存” 针对 "),_("code",[t._v("index.html")]),t._v("：浏览器始终可以请求 “最新的资源”。")])])]),t._v(" "),_("blockquote",[_("p",[t._v("不能使用强缓存，因为没有机制能够通知浏览器这些 "),_("code",[t._v(".html")]),t._v("有更新。")])]),t._v(" "),_("h2",{attrs:{id:"参考链接"}},[_("a",{staticClass:"header-anchor",attrs:{href:"#参考链接"}},[t._v("#")]),t._v(" 参考链接")]),t._v(" "),_("ul",[_("li",[_("a",{attrs:{href:"https://imweb.io/topic/5795dcb6fb312541492eda8c",target:"_blank",rel:"noopener noreferrer"}},[t._v("HTTP缓存控制小结"),_("OutboundLink")],1)]),t._v(" "),_("li",[_("a",{attrs:{href:"https://segmentfault.com/q/1010000013464267",target:"_blank",rel:"noopener noreferrer"}},[t._v("from memory cache与from disk cache"),_("OutboundLink")],1)]),t._v(" "),_("li",[_("a",{attrs:{href:"https://juejin.im/post/5e7ef4a9e51d4546f8784b21",target:"_blank",rel:"noopener noreferrer"}},[t._v("前端缓存那些事"),_("OutboundLink")],1)]),t._v(" "),_("li",[_("a",{attrs:{href:"https://juejin.im/post/6844903844044865550",target:"_blank",rel:"noopener noreferrer"}},[t._v("聊聊 CDN 缓存与浏览器缓存"),_("OutboundLink")],1)]),t._v(" "),_("li",[_("a",{attrs:{href:"https://mp.weixin.qq.com/s/8oL4Z4ewTl0VbQ_0BH4n7w",target:"_blank",rel:"noopener noreferrer"}},[t._v("新的浏览器缓存策略变更：舍弃性能、确保安全"),_("OutboundLink")],1)]),t._v(" "),_("li",[_("a",{attrs:{href:"https://www.chromestatus.com/feature/5730772021411840",target:"_blank",rel:"noopener noreferrer"}},[t._v("Partition the HTTP Cache"),_("OutboundLink")],1)])])])}),[],!1,null,null,null);e.default=v.exports}}]);